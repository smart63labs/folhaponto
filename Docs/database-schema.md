# Levantamento Total do Sistema - Tabelas e Relacionamentos

## Visão Geral

Este documento contém o levantamento completo das tabelas necessárias para o sistema de controle de ponto da SEFAZ-TO, baseado na análise de todos os componentes frontend e funcionalidades identificadas.

## Tabelas Existentes (do schema.sql atual)

1. **usuarios** - Usuários do sistema
2. **sessoes** - Sessões ativas dos usuários
3. **permissoes** - Permissões do sistema
4. **perfil_permissoes** - Relacionamento entre perfis e permissões
5. **auditoria_login** - Logs de tentativas de login

## Tabelas Necessárias Adicionais

6. **setores** - Setores organizacionais
7. **dados_pessoais** - Dados pessoais complementares dos usuários
8. **dados_profissionais** - Dados profissionais dos servidores
9. **enderecos** - Endereços dos usuários/servidores
10. **lotacao** - Informações de lotação dos servidores
11. **registros_ponto** - Registros de ponto
12. **escalas** - Escalas de trabalho
13. **feriados** - Feriados e dias não úteis
14. **ocorrencias** - Ocorrências/justificativas
15. **atestados** - Atestados médicos
16. **banco_horas** - Banco de horas
17. **formularios** - Formulários preenchidos
18. **templates_formularios** - Templates de formulários
19. **relatorios** - Relatórios gerados
20. **setores_hierarquia** - Relacionamentos hierárquicos entre setores
21. **configuracoes_sistema** - Configurações do sistema
22. **logs_auditoria** - Logs gerais de auditoria

## Estrutura Detalhada das Tabelas

### 1. usuarios
```sql
CREATE TABLE usuarios (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    email VARCHAR2(255) NOT NULL UNIQUE,
    senha_hash VARCHAR2(255) NOT NULL,
    nome VARCHAR2(255) NOT NULL,
    cpf VARCHAR2(14) UNIQUE,
    matricula VARCHAR2(20) UNIQUE,
    perfil VARCHAR2(50) NOT NULL CHECK (perfil IN ('SERVIDOR', 'CHEFIA', 'RH', 'ADMIN')),
    departamento VARCHAR2(100),
    cargo VARCHAR2(100),
    setor_id NUMBER, -- NOVO CAMPO: Vínculo com tabela setores
    ativo NUMBER(1) DEFAULT 1 CHECK (ativo IN (0, 1)),
    data_criacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    data_atualizacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    ultimo_login TIMESTAMP,
    tentativas_login NUMBER DEFAULT 0,
    bloqueado_ate TIMESTAMP,
    CONSTRAINT fk_usuarios_setor FOREIGN KEY (setor_id) REFERENCES setores(id)
);
```

### 2. sessoes
```sql
CREATE TABLE sessoes (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    usuario_id NUMBER NOT NULL,
    token_hash VARCHAR2(255) NOT NULL,
    ip_address VARCHAR2(45),
    user_agent VARCHAR2(500),
    data_criacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    data_expiracao TIMESTAMP NOT NULL,
    ativo NUMBER(1) DEFAULT 1 CHECK (ativo IN (0, 1)),
    CONSTRAINT fk_sessoes_usuario FOREIGN KEY (usuario_id) REFERENCES usuarios(id) ON DELETE CASCADE
);
```

### 3. permissoes
```sql
CREATE TABLE permissoes (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nome VARCHAR2(100) NOT NULL UNIQUE,
    descricao VARCHAR2(255),
    modulo VARCHAR2(50) NOT NULL,
    acao VARCHAR2(50) NOT NULL,
    data_criacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### 4. perfil_permissoes
```sql
CREATE TABLE perfil_permissoes (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    usuario_id NUMBER NOT NULL,
    permissao_id NUMBER NOT NULL,
    data_criacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_perfil_permissoes_usuario FOREIGN KEY (usuario_id) REFERENCES usuarios(id) ON DELETE CASCADE,
    CONSTRAINT fk_perfil_permissao FOREIGN KEY (permissao_id) REFERENCES permissoes(id) ON DELETE CASCADE
);
```

### 5. auditoria_login
```sql
CREATE TABLE auditoria_login (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    usuario_id NUMBER,
    email VARCHAR2(255) NOT NULL,
    ip_address VARCHAR2(45),
    user_agent VARCHAR2(500),
    sucesso NUMBER(1) NOT NULL CHECK (sucesso IN (0, 1)),
    motivo_falha VARCHAR2(255),
    data_tentativa TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_auditoria_usuario FOREIGN KEY (usuario_id) REFERENCES usuarios(id)
);
```

### 6. setores
```sql
CREATE TABLE setores (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR2(255) NOT NULL,
    code VARCHAR2(20) NOT NULL UNIQUE,
    parent_id NUMBER,
    manager_id NUMBER,
    description VARCHAR2(500),
    orgao VARCHAR2(255),
    logradouro VARCHAR2(255),
    numero VARCHAR2(20),
    complemento VARCHAR2(100),
    bairro VARCHAR2(100),
    cidade VARCHAR2(100),
    estado VARCHAR2(2),
    cep VARCHAR2(9),
    telefone VARCHAR2(20),
    email VARCHAR2(255),
    latitude NUMBER(10,8),
    longitude NUMBER(11,8),
    active NUMBER(1) DEFAULT 1,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_setores_parent FOREIGN KEY (parent_id) REFERENCES setores(id),
    CONSTRAINT fk_setores_manager FOREIGN KEY (manager_id) REFERENCES usuarios(id)
);
```

### 3. dados_pessoais
```sql
CREATE TABLE dados_pessoais (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    usuario_id NUMBER NOT NULL UNIQUE,
    pis_pasep VARCHAR2(15),
    sexo CHAR(1) CHECK (sexo IN ('M', 'F')),
    estado_civil VARCHAR2(20),
    data_nascimento DATE,
    pai VARCHAR2(255),
    mae VARCHAR2(255),
    rg VARCHAR2(20),
    tipo_rg VARCHAR2(50),
    orgao_expeditor VARCHAR2(10),
    uf_rg CHAR(2),
    expedicao_rg DATE,
    cidade_nascimento VARCHAR2(100),
    uf_nascimento CHAR(2),
    tipo_sanguineo VARCHAR2(5),
    raca_cor VARCHAR2(20),
    pne NUMBER(1) DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_dados_pessoais_usuario FOREIGN KEY (usuario_id) REFERENCES usuarios(id) ON DELETE CASCADE
);
```

### 4. dados_profissionais
```sql
CREATE TABLE dados_profissionais (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    usuario_id NUMBER NOT NULL UNIQUE,
    num_func VARCHAR2(20),
    num_vinc VARCHAR2(20),
    tipo_vinculo VARCHAR2(50),
    categoria VARCHAR2(50),
    regime_jur VARCHAR2(50),
    regime_prev VARCHAR2(50),
    tipo_evento VARCHAR2(50),
    forma_prov VARCHAR2(50),
    codigo_cargo VARCHAR2(20),
    cargo VARCHAR2(100),
    escolaridade_cargo VARCHAR2(50),
    escolaridade_servidor VARCHAR2(50),
    formacao_profissional_1 VARCHAR2(255),
    formacao_profissional_2 VARCHAR2(255),
    jornada VARCHAR2(20),
    nivel_ref VARCHAR2(50),
    comissao_funcao VARCHAR2(100),
    dt_ini_comissao DATE,
    setor_id NUMBER, -- NOVO CAMPO: Referência para tabela setores
    situacao VARCHAR2(50), -- NOVO CAMPO: Status do servidor (ATIVO, INATIVO, etc.)
    data_admissao DATE, -- NOVO CAMPO: Data de admissão
    data_demissao DATE, -- NOVO CAMPO: Data de demissão
    salario NUMBER(10,2), -- NOVO CAMPO: Salário
    carga_horaria NUMBER(3), -- NOVO CAMPO: Carga horária
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_dados_profissionais_usuario FOREIGN KEY (usuario_id) REFERENCES usuarios(id) ON DELETE CASCADE,
    CONSTRAINT fk_dados_profissionais_setor FOREIGN KEY (setor_id) REFERENCES setores(id)
);
```

### 5. enderecos
```sql
CREATE TABLE enderecos (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    usuario_id NUMBER NOT NULL UNIQUE,
    logradouro VARCHAR2(255),
    numero VARCHAR2(20),
    complemento VARCHAR2(100),
    bairro VARCHAR2(100),
    cidade VARCHAR2(100),
    estado CHAR(2),
    cep VARCHAR2(9),
    sem_numero NUMBER(1) DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_enderecos_usuario FOREIGN KEY (usuario_id) REFERENCES usuarios(id) ON DELETE CASCADE
);
```

### 10. lotacao
```sql
CREATE TABLE lotacao (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    usuario_id NUMBER NOT NULL UNIQUE,
    setor_id NUMBER,
    orgao VARCHAR2(255),
    setor VARCHAR2(100),
    lotacao VARCHAR2(100),
    municipio_lotacao VARCHAR2(100),
    situacao VARCHAR2(20) DEFAULT 'ATIVO',
    hierarquia_setor VARCHAR2(500),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_lotacao_usuario FOREIGN KEY (usuario_id) REFERENCES usuarios(id) ON DELETE CASCADE,
    CONSTRAINT fk_lotacao_setor FOREIGN KEY (setor_id) REFERENCES setores(id)
);
```

### 11. registros_ponto
```sql
CREATE TABLE registros_ponto (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    usuario_id NUMBER NOT NULL,
    data DATE NOT NULL,
    entrada TIMESTAMP,
    saida_almoco TIMESTAMP,
    retorno_almoco TIMESTAMP,
    saida TIMESTAMP,
    horas_trabalhadas INTERVAL DAY TO SECOND,
    justificativa VARCHAR2(500),
    status VARCHAR2(20) DEFAULT 'PENDENTE',
    aprovado_por NUMBER,
    data_aprovacao TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_registros_ponto_usuario FOREIGN KEY (usuario_id) REFERENCES usuarios(id),
    CONSTRAINT fk_registros_ponto_aprovador FOREIGN KEY (aprovado_por) REFERENCES usuarios(id)
);
```

### 12. escalas
```sql
CREATE TABLE escalas (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nome VARCHAR2(100) NOT NULL,
    descricao VARCHAR2(255),
    setor_id NUMBER,
    tipo VARCHAR2(20) DEFAULT 'PADRAO', -- PADRAO, FLEXIVEL, PLANTAO
    jornada_padrao VARCHAR2(20) DEFAULT '8h',
    dias_trabalho VARCHAR2(50) DEFAULT '2-6', -- Ex: 2-6 (segunda a sexta)
    horario_entrada VARCHAR2(5) DEFAULT '08:00',
    horario_saida VARCHAR2(5) DEFAULT '17:00',
    horario_almoco_inicio VARCHAR2(5) DEFAULT '12:00',
    horario_almoco_fim VARCHAR2(5) DEFAULT '13:00',
    ativo NUMBER(1) DEFAULT 1,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_escalas_setor FOREIGN KEY (setor_id) REFERENCES setores(id)
);
```

### 13. feriados
```sql
CREATE TABLE feriados (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nome VARCHAR2(100) NOT NULL,
    data DATE NOT NULL,
    tipo VARCHAR2(20) DEFAULT 'NACIONAL', -- NACIONAL, ESTADUAL, MUNICIPAL
    uf CHAR(2),
    municipio VARCHAR2(100),
    setor_id NUMBER,
    ativo NUMBER(1) DEFAULT 1,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_feriados_setor FOREIGN KEY (setor_id) REFERENCES setores(id)
);
```

### 14. ocorrencias
```sql
CREATE TABLE ocorrencias (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    usuario_id NUMBER NOT NULL,
    tipo VARCHAR2(50) NOT NULL,
    data_inicio DATE NOT NULL,
    data_fim DATE,
    descricao VARCHAR2(500),
    anexo VARCHAR2(255),
    status VARCHAR2(20) DEFAULT 'PENDENTE',
    aprovado_por NUMBER,
    data_aprovacao TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_ocorrencias_usuario FOREIGN KEY (usuario_id) REFERENCES usuarios(id),
    CONSTRAINT fk_ocorrencias_aprovador FOREIGN KEY (aprovado_por) REFERENCES usuarios(id)
);
```

### 15. atestados
```sql
CREATE TABLE atestados (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    usuario_id NUMBER NOT NULL,
    tipo VARCHAR2(50) NOT NULL,
    data_emissao DATE NOT NULL,
    data_inicio DATE NOT NULL,
    data_fim DATE NOT NULL,
    cid VARCHAR2(10),
    medico VARCHAR2(255),
    crm VARCHAR2(20),
    anexo VARCHAR2(255),
    status VARCHAR2(20) DEFAULT 'PENDENTE',
    aprovado_por NUMBER,
    data_aprovacao TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_atestados_usuario FOREIGN KEY (usuario_id) REFERENCES usuarios(id),
    CONSTRAINT fk_atestados_aprovador FOREIGN KEY (aprovado_por) REFERENCES usuarios(id)
);
```

### 16. banco_horas
```sql
CREATE TABLE banco_horas (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    usuario_id NUMBER NOT NULL,
    data DATE NOT NULL,
    tipo VARCHAR2(20) NOT NULL, -- CREDITO, DEBITO
    horas INTERVAL DAY TO SECOND NOT NULL,
    justificativa VARCHAR2(255),
    saldo_anterior INTERVAL DAY TO SECOND,
    saldo_atual INTERVAL DAY TO SECOND,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_banco_horas_usuario FOREIGN KEY (usuario_id) REFERENCES usuarios(id)
);
```

### 17. templates_formularios
```sql
CREATE TABLE templates_formularios (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nome VARCHAR2(100) NOT NULL,
    descricao VARCHAR2(255),
    categoria VARCHAR2(50),
    estrutura CLOB, -- JSON com estrutura do formulário
    campos_obrigatorios VARCHAR2(1000), -- Lista de campos obrigatórios
    ativo NUMBER(1) DEFAULT 1,
    created_by NUMBER,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_templates_created_by FOREIGN KEY (created_by) REFERENCES usuarios(id)
);
```

### 18. formularios
```sql
CREATE TABLE formularios (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    template_id NUMBER NOT NULL,
    usuario_id NUMBER NOT NULL,
    dados CLOB, -- JSON com dados preenchidos
    status VARCHAR2(20) DEFAULT 'RASCUNHO',
    enviado_em TIMESTAMP,
    aprovado_em TIMESTAMP,
    aprovado_por NUMBER,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_formularios_template FOREIGN KEY (template_id) REFERENCES templates_formularios(id),
    CONSTRAINT fk_formularios_usuario FOREIGN KEY (usuario_id) REFERENCES usuarios(id),
    CONSTRAINT fk_formularios_aprovador FOREIGN KEY (aprovado_por) REFERENCES usuarios(id)
);
```

### 19. relatorios
```sql
CREATE TABLE relatorios (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nome VARCHAR2(100) NOT NULL,
    tipo VARCHAR2(50) NOT NULL,
    parametros CLOB, -- JSON com parâmetros do relatório
    resultado CLOB, -- JSON ou dados do relatório
    formato VARCHAR2(10) DEFAULT 'PDF',
    gerado_por NUMBER NOT NULL,
    gerado_em TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    arquivo VARCHAR2(255),
    CONSTRAINT fk_relatorios_gerado_por FOREIGN KEY (gerado_por) REFERENCES usuarios(id)
);
```

### 20. setores_hierarquia
```sql
CREATE TABLE setores_hierarquia (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    setor_pai_id NUMBER NOT NULL,
    setor_filho_id NUMBER NOT NULL,
    nivel NUMBER NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_hierarquia_pai FOREIGN KEY (setor_pai_id) REFERENCES setores(id),
    CONSTRAINT fk_hierarquia_filho FOREIGN KEY (setor_filho_id) REFERENCES setores(id),
    CONSTRAINT uk_hierarquia UNIQUE (setor_pai_id, setor_filho_id)
);
```

### 21. configuracoes_sistema
```sql
CREATE TABLE configuracoes_sistema (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    chave VARCHAR2(100) NOT NULL UNIQUE,
    valor VARCHAR2(1000),
    tipo VARCHAR2(20) DEFAULT 'STRING',
    descricao VARCHAR2(255),
    modificado_por NUMBER,
    modificado_em TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_config_modificado_por FOREIGN KEY (modificado_por) REFERENCES usuarios(id)
);
```

### 22. logs_auditoria
```sql
CREATE TABLE logs_auditoria (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    tabela VARCHAR2(50) NOT NULL,
    registro_id NUMBER,
    operacao VARCHAR2(10) NOT NULL, -- INSERT, UPDATE, DELETE
    usuario_id NUMBER,
    dados_anteriores CLOB,
    dados_novos CLOB,
    ip_address VARCHAR2(45),
    user_agent VARCHAR2(500),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_logs_auditoria_usuario FOREIGN KEY (usuario_id) REFERENCES usuarios(id)
);
```

## Relacionamentos Principais

```
usuarios (1) ──── (1) dados_pessoais
usuarios (1) ──── (1) dados_profissionais
usuarios (1) ──── (1) enderecos
usuarios (1) ──── (1) lotacao
usuarios (1) ──── (N) registros_ponto
usuarios (1) ──── (N) sessoes
usuarios (1) ──── (N) ocorrencias
usuarios (1) ──── (N) atestados
usuarios (1) ──── (N) banco_horas
usuarios (1) ──── (N) formularios
usuarios (1) ──── (N) relatorios
usuarios (1) ──── (N) auditoria_login
usuarios (N) ──── (N) perfil_permissoes (via perfil)

setores (1) ──── (N) usuarios (lotacao)
setores (1) ──── (1) setores (pai)
setores (N) ──── (N) setores_hierarquia

permissoes (1) ──── (N) perfil_permissoes
perfil_permissoes (1) ──── (1) usuarios

escalas (1) ──── (N) registros_ponto
feriados (1) ──── (N) setores

templates_formularios (1) ──── (N) formularios
```

## Diagrama de Relacionamentos

```
┌─────────────────┐    ┌──────────────────┐
│     usuarios    │    │     setores      │
│                 │    │                  │
│ - id            │    │ - id             │
│ - email         │    │ - name           │
│ - senha_hash    │    │ - code           │
│ - nome          │    │ - parent_id      │
│ - cpf           │    │ - manager_id     │
│ - matricula     │    │ - description    │
│ - perfil        │    │ - active         │
│ - ativo         │    │ - created_at     │
└─────────┬───────┘    └─────────┬────────┘
          │                      │
          │1                     │1
          │                      │
          │                      │N
          │                      │
┌─────────▼────────┐    ┌────────▼────────┐
│ dados_pessoais   │    │   lotacao       │
│                  │    │                 │
│ - usuario_id     │    │ - usuario_id    │
│ - pis_pasep      │    │ - setor_id      │
│ - rg             │    │ - orgao         │
│ - tipo_rg        │    │ - setor         │
│ - ...            │    │ - lotacao       │
└──────────────────┘    └─────────────────┘

┌─────────────────┐    ┌──────────────────┐
│ dados_profiss.  │    │   enderecos      │
│                 │    │                  │
│ - usuario_id     │    │ - usuario_id     │
│ - num_func       │    │ - logradouro     │
│ - tipo_vinculo   │    │ - numero         │
│ - cargo          │    │ - bairro         │
│ - ...            │    │ - cidade         │
└─────────────────┘    └──────────────────┘

┌─────────────────┐    ┌──────────────────┐
│ registros_ponto │    │   ocorrencias    │
│                 │    │                  │
│ - usuario_id     │    │ - usuario_id     │
│ - data           │    │ - tipo           │
│ - entrada        │    │ - data_inicio    │
│ - saida          │    │ - data_fim       │
│ - justificativa  │    │ - descricao      │
└─────────────────┘    └──────────────────┘
```

## Considerações para Implementação

1. **Extensão da tabela usuarios**: Adicionar campos básicos que estão faltando
2. **Tabelas complementares**: Criar tabelas separadas para dados extensos
3. **Chaves estrangeiras**: Implementar todas as FKs para integridade referencial
4. **Índices**: Criar índices apropriados para performance
5. **Triggers**: Para auditoria e campos calculados
6. **Views**: Para consultas complexas
7. **Sequences**: Para geração automática de IDs

## Próximos Passos

1. Criar script SQL completo com todas as tabelas
2. Implementar migrations para evolução do schema
3. Criar índices e constraints
4. Desenvolver triggers de auditoria
5. Testar integridade referencial
6. Documentar procedures e functions necessárias

Este levantamento cobre todas as funcionalidades identificadas no sistema frontend e garante uma estrutura de banco robusta e normalizada.